---
layout: default_citoyens
additional_css: catalogue_citoyen
title: "Catalogue"
---
<a href="https://airtable.com/shrZJ8XgkvQqrUVpj" target="_blank" class="row d-flex align-items-center justify-content-end" id="bandeau-notifications">
  <p>Inscrivez-vous au service de notification automatique (sms/mail) <img src="/img/citoyens/icons/enveloppe.png" alt="icone enveloppe"></p>
</a>

<div class="row" id="bandeau-recherche">
  <div class="container d-flex flex-column align-items-center">
    <h2 class="row d-flex justify-content-center">Contribuez et suivez toutes les démarches citoyennes de l'Etat</h2>
    <div class="row" id="barre-recherche">
      <div class="col-md-8 col offset-md-2">
        <input id="search" name="search" placeholder="Ma ville, mon code postal, mon centre d'intérêt ...." type="text" data-list=".list" class="form-control" >
        <i class='fas fa-search'></i>
      </div>
    </div>
  </div>
</div>

<div class="container" id="results">
  <div class="row ligne-filtres">
    <!-- filtre spécial -->
    <div class="form-group col-md-2">
      <select v-model="echelle" name="echelle" id="echelle" class="form-control" data-list=".list" >
        <option value="">Echelle</option>
        <option value='national'>National</option>
        <option value='régional'>Régional</option>
        <option value='local'>Local</option>
      </select>
    </div>
    <!-- fin filtre spécial -->
  </div>
  <div class="row list" >
    <div v-for="item in items" class="col-md-4 col-12 mt-4 citoyen-card">
      <div class="mb-3 card">
        <div class="">
          <h5>
            <a class="header" :href="item.fields.url" v-text="item.fields.title"></a>
          </h5>
        </div>
        <div class="card-body d-flex justify-content-center align-items-center">
          <a class="image" v-if="item.fields.screenshot && item.fields.screenshot[0]" :href="item.fields.url" :style="getImageStyleProperties(item)">
          </a>
          <a href="https://airtable.com/shrZJ8XgkvQqrUVpj" target="_blank" class="far fa-heart"></a>
        </div>
        <div class="card-footer bg-transparent extra content d-flex justify-content-between align-items-center">
        </div>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.rawgit.com/vdw/HideSeek/master/jquery.hideseek.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/vue"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.min.js"></script>
<script src="https://unpkg.com/moment"></script>

<script>
$(document).ready(function() {
  $('#search').hideseek({
    nodata: 'Aucun résultat trouvé pour cette recherche',
    ignore_accents: true
  })
});
</script>
<script type="text/javascript">
var results = new Vue({
  el: '#results',
  data: {
    items: [],
    echelle: ''
  },
  mounted: function(){
    this.loadItems();
  },
  methods: {
    loadItems: function (filters) {
      var self = this
      var app_id = "appGm0fBXKeCfIHSH";
      var app_key = "keyXfCXZNCfIupNra";
      axios.get(
        "https://api.airtable.com/v0/"+app_id+"/Catalogue-citoyen?" + (!!filters && `filterByFormula=${filters}` || '' ),
        {
          headers: { Authorization: "Bearer "+app_key }
        }
      ).then(response => {
        self.items = self.items.concat(response.data.records);
        if (response.data.offset){
          this.loadItems(response.data.offset)
        }
      })
    },
    getImageStyleProperties:function(item){
      return 'background: url(' + item.fields.screenshot[0].url + '); background-size: cover';
    },
    formatDate: function (date) {
      return moment(date).format('L');
    }
  },
  watch: {
    'echelle': function(val){
      console.log(val)
      this.items = []
      this.loadItems(val)
    }
  }
})
</script>
